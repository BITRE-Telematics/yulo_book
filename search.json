[{"path":"index.html","id":"welcome","chapter":"Welcome!","heading":"Welcome!","text":"Bureau Infrastructure Transport Research Economics running program turn telematics data information road freight industry Australia. Now code project public ’re providing document talk problems ’ve faced decisions ’ve made. call process Yulo. many things aren’t , hope help use results, use code. ’ve tried make readable accessible. first, telematics?","code":""},{"path":"why-telematics.html","id":"why-telematics","chapter":"1 Why Telematics?","heading":"1 Why Telematics?","text":"anything telematics ? ’s hard get anywhere don’t goals, three main goals heading project. get information activity, road freights network, stops.","code":""},{"path":"why-telematics.html","id":"activity","chapter":"1 Why Telematics?","heading":"Activity","text":"years ago - people desks Canberra - problem. years great deal knew road freight Australia came survey. Every years, month, sample drivers asked record trips , time, learn month…costly everyone involved , everyone else freight needs.want time information activity. Government wants know going businesses getting stock expect sell , can flow demand accross economy. Firms know less business want know everyone else; everyone slump something wrong. One month every years enough.","code":""},{"path":"why-telematics.html","id":"roads","chapter":"1 Why Telematics?","heading":"Roads","text":"Governments also need know trucks going. spend lot money roads trucks use, roads spend ones used. route might appear obvious one looks map, drivers prefer route without sun eyes, one avoids particular intersection busy road. reasons don’t take “obvious” route obvious , us. government make sure know ?Firms government also need know network performs different times, peak times can much slower also far uncertain making hard know destination arrived . Knowing happens can help investment government planning firms. can also help freight firms clients find times make delivery certain less costly.","code":""},{"path":"why-telematics.html","id":"stops","chapter":"1 Why Telematics?","heading":"Stops","text":"Australian governments also spend lot rest areas, make sure drivers can rest long journeys, right place, avoided don’t right facilities?’s much don’t even know don’t know yet.first, look work .","code":""},{"path":"the-raw-stuff.html","id":"the-raw-stuff","chapter":"2 The raw stuff","heading":"2 The raw stuff","text":"","code":""},{"path":"the-raw-stuff.html","id":"where-does-the-data-come-from-and-why","chapter":"2 The raw stuff","heading":"Where does the data come from, and why?","text":"data come private firms, smaller, larger. give us data think can benefit. can benefit better investment roads stops. can benefit seeing activity compares industry whole. can benefit able plan journeys different times different routes. also need trust us won’t used anything else, respect privacy. keen maintain trust.","code":""},{"path":"the-raw-stuff.html","id":"what-does-it-look-like","chapter":"2 The raw stuff","heading":"What does it look like","text":"get data bunch formats, including xml, json csv comes telematics data just long list observations. device pings every often reporting “time.” longitude, latitude, time id. ’s . Sometimes might get things like speedometer reading even compass direction (call azimuth) usually. Turning long list pings information freight network obvious.Table 2.1: Sample unprocessed dataBut first, lets just closer look pings notice stuff funny even start.","code":""},{"path":"the-raw-stuff.html","id":"gps-error","chapter":"2 The raw stuff","heading":"GPS error","text":"","code":""},{"path":"the-raw-stuff.html","id":"repeated-observations","chapter":"2 The raw stuff","heading":"Repeated observations","text":"first looked data ’d occasionally note trucks just…stopped. wasn’t just place, exactly place. truck stopped usually looks like moving around just little bit GPS error, place, 5-6 decimal places, minutes end. Moreover middle road, didn’t seem likely. particular noted places like map , mouth CityLink tunnel. GPS devices work listening satellites constantly shouting , tunnel satellites heard, GPS devices didn’t know . Unable create correct location, sometimes gave error times just report last place sure , mouth tunnel. Subsequently, good time apparently loitering entrance tunnel, abruptly appear exit. Whatever need account happened tunnel even GPS couldn’t tell us directly.","code":""},{"path":"the-raw-stuff.html","id":"weirder-errors","chapter":"2 The raw stuff","heading":"Weirder errors","text":"let’s get work.","code":""},{"path":"trips-and-stops.html","id":"trips-and-stops","chapter":"3 Trips and stops","heading":"3 Trips and stops","text":"first step must cleaning data, right? Garbage , garbage ; start working highly flawed data won’t get good results. ’ve got get rid erroneous jumps middle Moreton Bay, loitering entrance tunnels. can get work working really .? errors obvious?jumps forest sea easy realise false, simply filter areas. Except road forest, car ferry, haven’t started matching roads yet know? Anyway, jumps might parts urban area, even roads. real give away moving quickly, even straight highway Moreton bay couldn’t go dozens kilometres minute. ’re really making inferences assume reasonable behaviour, also ’re going work trucks . maybe can combine two.goals three things trucks. Activity, going origins (stop) destination (stop). Information road network, use stopped, stops , uh, stop.may noticed theme . truck either stopped stopped, subsequent analysis relies distinction. also matters great deal use resources; don’t want match lot observations stationary vehicles road network.","code":""},{"path":"trips-and-stops.html","id":"options","chapter":"3 Trips and stops","heading":"Options","text":"short needed find stops. Everything wasn’t stop trip.first attempt see trucks stopped used speed variable firms provided. firms didn’t provide , start. stopped truck value 0 right? results weren’t encouraging. lot time looked like trucks stopped road, times loiter around rest stop low speeds (around 5kph) 20 minutes . speed variable wasn’t just limited portion data, seemed little messy. anyway, truck depot, moved side pick something got ping whilst moving. Normally ’d consider everything depot stop, speed variable pick trip.also briefly considered whether just take series observations vicinity known location stops. observations loitering around rest stop, supermarket, depot likely stopped . get locations ? keep list date freight environment changes time, businessed open close constantly. Moreover one major concerns drivers using informal rest areas instead formal ones. ’d know location knew . Instead needed “unsupervised” approach, find stop locations didn’t already know .Eventually stumbled across Belgian paper also concerned grouping GPS traces trips stops. weren’t concerned trucks even vehicles, creating prompts activity surveys; noting stop one location person filling survey might remember . adapt methodology fairly easily1.approach based around clustering. stop just trace stayed within given radius given time.start first observation. ’ll provisionally put stop now.Now look next stop see far away . within given radius still provisional stop, add point well, calculate centroid, average position stop, points. compare next observations . Also, exactly last point ’s one repeated observations, just chuck .provisional stop isn’t long enough, observations added last provisional trip. truck moving prior provisional stop event already observations ., every time confirm end trip event, trip stop pair; summary data stop, observations leading stop, can record .potential bogey case however. Imagine truck depot stops one side property. GPS unit doesn’t ping ignition 2 stop event , due random GPS error, pace fence. moves side property get loaded. ’s quite possible end two stops either side depot, “trip” one two observations . case ’d reasonably call single stop. can check see stops sufficiently close time space , , combine whilst discarding trip .Incidentally need give unique IDs trips stops. number order vehicle, get earlier data? universal list ’s another thing maintain. Instead can just exploit fact vehicles can one place time. id trip stop vehicle ID time starts, hexidecimal, stuck end.","code":""},{"path":"trips-and-stops.html","id":"does-it-work","chapter":"3 Trips and stops","heading":"Does it work","text":"Seemingly yes! first tried sample data spent great deal time looking stops spot bogeys. light industrial areas rest areas highways, quite looked less obvious. found cluster mountains just west Central Coast, satellite imagry showed cleared area next powerlines trucks visible, presumably materials repair maintenance. Another opposite service station Federal Highway leading Canberra, (repeated) physical observation let us see trucks parked shady tree road. cluster remote highway Western Australia, Google Street View imagery aerial photography showed trucks, tyre marks nowhere even park road scrub, afterwards newer imagery showed freshly built rest area.Things appeared work well, ordered data, cleaned time. Moreover, finding locations even without knowing hand. Things made sense.","code":""},{"path":"trips-and-stops.html","id":"a-note-on-parameters","chapter":"3 Trips and stops","heading":"A note on parameters","text":"whole process requires parameters. long stop? big reasonable stop area? fast fast jump considered valid? close time space stops need considered single stop. others well. choose ?honest answer…depends.concerned entirely freight, relatively low resolution data. stops care entail rest breaks loading unloading freight, usually imply longer time, settled threshold 15 minutes. Given one ping every 1 5 minutes lower resolution probably wasn’t feasible anyway. ’d lose hurried toilet breaks, quick refueling incredibly efficient loading unloading2 ’d live .people adapted uses, public transport pedestrian traffic make choices, probably face tradeoff getting short stops avoiding spurious “stops” traffic lights congestion., choosing shorter stop duration also means faster processing line. shorter stop duration, stops get observations stops. observations stops stops can discarded instead matched map.","code":""},{"path":"trips-and-stops.html","id":"implementation","chapter":"3 Trips and stops","heading":"Implementation","text":"Unlike map matching (’ll cover next part) existing code us adapt. scratch. ’re economists training, programmers, started knew, R, language made statistics. enough confirm hat process worked, slow R really wasn’t tool job. ’s good analysis statistics large scale tasks regularly, even expecting hundreds millions observations.tried Python also popular statistical work, also runs services production, also slow, taking minute process whole vehicle. lark tried rewriting Python code different style [^away loops map reduces, broadly imperative functional] unexpectedly reduced processing times two thirds, still slow. R Python scripting languages, easy write fly slower run. Great ad hoc tasks ongoing work. needed compiled language instead.Usually ongoing task R Python slow implement particular thing compiled language, like C++, call R Python tool like Rcpp, decided . one part process, might well make much process one program. many popular compiled languages, C family, Java map matching coded (see next chapter). Eventually went Go, one main reason. Every one vehicles processed independently, happened one irrelevant rest. , computing jargon, made work “embarrassingly parallel,” work split processors CPU done time. Go designed make part easy.tripgrouping incorporated larger program co-ordinated Yulo process, including interacting map matching server, next chapter.","code":""},{"path":"what-roads-are-they-on.html","id":"what-roads-are-they-on","chapter":"4 What roads are they on?","heading":"4 What roads are they on?","text":"find trucks using road, need know roads using. fact, need know roads .\n##Matching ?\nFirst go seems like digression pretty important one’s head around. road get idea road computer?don’t usually think don’t need . road thing vehicles go , Romans built long cars mainly used marching. ’re made tar, except ’re made concrete stone , like majority Australia’s roads, just dirt. place vehicles can go, except shared zones. ’re place vehicles can go, except garages driveways carparks roads…? Roads ground, also use bridges tunnels. road?purposes looking transport road freight. Freight moving stuff one point another place. road thing use move one place another surface land transport, like trucks case. ’re really worried roads place, just way going two places. fact many places many places. put messy idea roads computer. road outside building now way getting next intersection, next intersection curve road, one gets next suburb, next city, next state.people call network. Mathematicians like calling graph. bunch points connected lines. points (nodes) places, lines (edges) connect . roads. width, just start end.famous example comes 18th century mathemetician Leonhard Euler. ’s Wikipedia shows constructed graph city whilst attempting solve problem now known Seven Bridges Königsberg. land mass node, bridge edge.3An image wikipedia showing detailed image Koenigsburg abstracted graphThere’s bunch choices make abstractions like .many places . road windy straight may want add points lines can see better goes long , precise choice, trading precision avoid dataset ungainly. Euler didn’t care , .\n’d impractical every edge two nodes called road , lest every kink road creates new road. instead group together string nodes edges. long groupings? Imagine shops Newtown, Sydney. road ? people say “King St,” goes Broadway St Peters. King St also Princes Highway, keeps going Kogarah, Nowra, Melbourne way Adelaide. ’s far long purposes, since happens King St doesn’t affect Western Victoria, even King St long traffic north intersection Enmore Rd South . end groupings also choices seems practical useful.now , call groupings “segments.”task, find segments trucks data set using.","code":""},{"path":"what-roads-are-they-on.html","id":"which-data","chapter":"4 What roads are they on?","heading":"Which data","text":"get data? might seem strange governments don’t always right hand already. , different levels government manage different roads, many roads aren’t built government. Different state governments may data set, roads local many local councils just know roads . Government, collectively, information, single data set.organisations need single dataset, notably many telematics mapping firms. data essential businesses charge accordingly. quite apart expense, ’s use data can used others also able prepapared shell huge funds? ’s also unclear quickly can get updates. Trucks start using motorway moment opened, data yet? mistake, might fix copy data doesn’t help user data road data paid .proprietary data providers also somewhat coy collated data, ’m pretty sure know .image two astronauts space, looking earth covered OSM logo. One exclaims “wait, ’s OpenStreetMap!?” , holding gun former’s back, declares ominously “Always ”OpenSteetMap (OSM) like Wikipedia spatial data, created cuated open group dedicated volunteers. unlike Wikipedia, read many people, users OSM don’t know using . underlies many popular apps, whether providing public transport information Pokemon Go, relied even largest firms. usally obvious things go wrong, instance unexpected results Flight Simulator,4 made Bing Map’s owner Microsoft. also suspect reason unexpected nomenclature Google Maps5.OSM data free everyone, means data matched , anyone can use . find mistake can fix , fix everyone, best , gives us access lots open source tools working .","code":""},{"path":"what-roads-are-they-on.html","id":"what-method","chapter":"4 What roads are they on?","heading":"What method?","text":"match trucks segments. Remember Part 2 inevitable GPS error means observations always jumping around random noise. Moreover road segments one dimensional, even GPS entirely accurate trucks wouldn’t line unless middle road, hope aren’t!\neasiest method just assuming whichever segment closest. called nearest neighbour matching. computer takes segments within given radius checks one closest. Simple! problems approach.first random GPS error, often enough put observation closer side road, road next motorway. ’s obvious image Southbank saw Part 2. want something accurate .Obviously, noted earlier, segments never give us observations tunnels GPS hear satellites. still care ,fact ’re usually incredibly important motorways.Less obviously biases sample towards slower vehicles. Imagine two vehicles, one fast one slow, reporting minute. fast vehicle goes twice fast slow. fast vehicle uses 10 segments minute, recorded one. slow vehicle takes 2 minutes reports twice. Two thirds observations segments now slow vehicle. real average speed 75 per cent fast vehicle, data makes looks like 66 per cent. stylised example greater number slower observations add . Slower vehicles spend time given segment, likely ping, data gets biased. ’s speed data anyway.Ideally ’d use something else.\n## Hidden Markov Map Matching?{-}\nThink back South Melbourne map . ’s obvious us points side motorway surface streets really motorway, obvious. joined dots order ’d even clearer. Trucks motorway much likely stayed motorway left via offramp get surface road close motorway. short balancing probabilities observation right road probable truck taken route necessary get .core Hidden Markov Map Matching (HMMM). select candidates segments near observation calculate routes last observation. Segments closer observation likely, segments shorter routes higher graded routes also likely. choice balance two. match first observation? Well still use nearest neighbour.care called Hidden Markov Map Matching. Like Markov chain probability next observation’s location function last observation, “hidden” first observation educated guess. match map.accurate immediately get benefits. Since calculated likely route also know road segments vehicle used, even didn’t ping , tunnel. Now data segments. also length route time took, means can calculate average speed well. great isn’t biased towards slower vehicles, better reflects travel experience point estimates can zero (traffic light) momentarily faster average. importantly, gives us speeds vast majority vehicles speed data.","code":""},{"path":"what-roads-are-they-on.html","id":"why-barefoot","chapter":"4 What roads are they on?","heading":"Why Barefoot?","text":"’s cliche best code code don’t write . fact framework book lightly reworked version Using R Grattan, turn built open source tools. HMMM many implementations needed find one work us scale. search stumbled across repository Github called Barefoot.Now Barefoot wasn’t created task. unconcerned speeds sampling. fact fairly unconcerned actual road segment matched . main concern correcting dot car display , actually road, real time. required testing troubleshooting batches sample data, recording road ids check things working fine. exploit debugging tools ends.won’t go much detail work needed Barefoot, aided generous assistance authors maintainers. short started server, written Java, take stream GPS pings cars return pings lat lons OSM road network. ended Java server take whole trips GPS pings return.6an OSM segment IDa list OSM segment IDs used reach segment (available)distance traveled network get segmentthe average speed experiencedthe direction traveled segment##bogies\nran problems didn’t expect.related known problem HMMM. Whilst average error HMMM much less nearest neighbour matching, make error gets much worse quickly. Say HMMM mistakenly thinks truck turned motorway still one. next observation likely motorway. case map matching might try get truck back motorway routing nearest ramp. Alternately might deem unlikely decide next observation error truck still side road. either case route longer one truck actually took appears truck going fast. , decided truck motorway, ’ll process , , errors getting larger decides options improbable starts .Fortunately relatively rare can managed judiciously managed parameters.thought. ran two unexpected problems.Data one firm particular giving us problems. often, trucks firm travelling along motorways Barefoot determine jumping small residential surface street small residential surface street, tearing cul de sacs high speed rarely returning motorway. Barefoot think likely motorway. Indeed looked raw data offending observation closer side streets motorway, algorithm meant account . weren’t just closer side streets, right . just right area street two dimensional line representing street data. precise placement extremely unlikely even perfectly accurate data, unless driving middle road. clearly happened point telematics provider firm already matched data nearest neighbour “corrected” pings. time Barefoot saw data weight unliklihood route unlikelihood wasn’t street appeared perfectly placed.honest never solved problem. firm providing data started providing different form wasn’t pre matched, although unaware pre matching happened , never deal .second unexpected problem looked similar quite different. Instead single firm’s trucks mistakenly taken motorways country, every firm’s trucks taken particular stretches motorway. first noticed Southern Cross Drive Brisbane. Barefoot , without fail, route vehicles onto ramp onto surface streets. wasn’t didn’t know next observation motorway, fact time came back motorway another ramp get close recorded position, even mean travelling reverse position. whatever reason, Barefoot simply didn’t know trucks just keep going along motorway. ? road segments connected , one way direction correct. Furthermore wasn’t just Barefoot error. used Open Source Routing Machine7 OSM’s online display asked directions also route us . asked forums users, though helpful, also baffled. Eventually, comparing offramps mistakenly taken weren’t led us revelation. ones worked marked node labelled “motorway junction.” didn’t work just plain, unlabelled node. seems happens :Motorway segments attribute “motorway.” Motorway ramps attribute “motorway_link”motorway_link connected motorway node connect must marked “motorway junction” image left.labelled motorway junction (right) routing graph built data deem motorway connected motorway_link continuing motorway.image showing two type /ramp nodesAs far can tell wasn’t documented anywhere, easy fix, just users Australian OSM data. Fortunately applied segments “motorway” “motorway_link” , say, “primary” “primary_link” spent afternoon travelling along every stretch motorway Australia. Sydney one user systematically labelled node just ramp motorway junction instead one ramp. Apparently , foolishly, assumed node label indicated turn sign !one unexpected problem. Barefoot’s designers aware broad category problems faced - exponential error wrong decisions disconnected road systems due map data error - built safeguards. Barefoot stop investigating particular route exceeded certain threshold, say 15km. means , road network disconnected correct road, routing departed true route , even truck genuinely left road network engine futilely search entire country way , take resources end. Instead just give error route found. Barefoot designed tracking vehicles providing data every seconds isn’t big deal, using batches data reporting position every minute . caused problems. Imagine vehicle South Western Sydney. leaves deport heads South Hume Highway towards Canberra. whatever reason GPS unit conked 10 minutes. time come back online truck travelled 10 minutes 100km per hour, nearly 17km. Barefoot tries correct route, stops 15km tries every route within 15km depot, reports error. end map matching trip, also took lot time computation get error. increase threshold 20km, just means still problem system conks 15 minutes, take even longer get error. ’d also take longer kinds problem arise.solution fairly simple result. big time gap trip, ’d split giving Barefoot, joing back together later. wouldn’t get speed road data time, averaging 10 15 minutes likely wouldn’t tell us much individual segments anyway. ’d still likely want know distance travelled, impute instance Open Source Routing Machine, discuss later.now bunch stops bunch trips, road segments used trips, speed went. ’s lot data, handle ? first, ’sa bunch miscellaneous processing ’d like talk .","code":""},{"path":"other-stuff.html","id":"other-stuff","chapter":"5 Other stuff","heading":"5 Other stuff","text":"observations trips stop, ’ve matched former road network, data isn’t quite ready, ’s bunch housekeeping.","code":""},{"path":"other-stuff.html","id":"residuals","chapter":"5 Other stuff","heading":"Residuals","text":"Reading trips stops may realised record trip stop stop finishes ’ll usually data left trip stop pair hasn’t finished yet. residuals, can fairly easily stick front next batch data. problem arises want link chains stops (later example work). Linking stops order batch easy enough, batches bit trickier. append id last stop residual data ’s bit dangerous. first observation trip also last observation stop, get true start trip, can link unique time stamps across batches.","code":""},{"path":"other-stuff.html","id":"time-and-geocoding","chapter":"5 Other stuff","heading":"Time and geocoding","text":"far cared relative time given vehicle; observations come much. times Universal Mean Time, Unix epoch; number seconds since Midnight January 1st 1970. also important always used local time, trucks might travel suddenly forward backwards time cross state borders time zones.care great deal local time analysis; knowing times day rest stops road segments used congested. need know time zone stop observation . Australian context means knowing state .good reasons. Later analysis care lot state something happened, smaller units Australian geography SA2s. attribute small unit like SA2 trips observations get time zone, also get quick spatial index later work.Finding area points well known problem, volumes data can take lot tim matching hundreds millions observations. Luckily almost already matched less 2 million road segments tend stay one state, need map segments stops.’s problem however. using Australian Statistical Geographical Standard (ASGS) polygons ABS, hug coastline , closely sometimes hug banks major waterways near coast. means Bradfield Highway instance, used Sydney Harbour Bridge, SA2 Australia State, least according polygons. number vehicular ferries, Spirit Tasmania. addition, coastlines change. don’t just mean erosion sediment tides. People reclaim land build . particular near ports land scarce valuable, lot trucks stopping ports. can manually change shapefiles happens, ’d vigiliant.solution pretty simple - fail match SA2 just match nearest one instead - good example unexpected problem needed solving.","code":""},{"path":"other-stuff.html","id":"locations","chapter":"5 Other stuff","heading":"Locations","text":"Whilst stop definition doesn’t need known locations, specific locations care , particular rest areas. ’re matching stops SA2s, may well match rest areas well, can get sources. May well loading zones data well. wait, every street address country part G-NAF can match well. Since known processing can use algorithm like rtree quickly find location closest , close enough determine stop location.","code":""},{"path":"other-stuff.html","id":"confidentiality-and-clustering","chapter":"5 Other stuff","heading":"Confidentiality and clustering","text":"Lastly, care lot specific location (rather general, SA2 level location) stops, others. truck stops port, rest stop, informal rest area, important project reason firms provided data first place. stops particular businesses less important , published, might betray commercial information. Worse still, drivers take trucks home, stops can expose place residence. need way distinguishing places interested places none business.locations like rest stop ports ’s easy, informal rest areas? solution use clustering algorithm. finds find large number stops together time space, regularly used patch dirt highway. can filter stops based may vehicles. one vehicle might someone’s home, ignored. one firm might client depot, also ignore . used variety firms interest us.’ve got lot information now, handle ?","code":""},{"path":"storage---why-a-graph.html","id":"storage---why-a-graph","chapter":"6 Storage - Why a graph?","heading":"6 Storage - Why a graph?","text":"producing lots data every month. Hundreds thousands stops, hundreds millions observations, billions total. ’s far much put csv. need database ’re going work , kind.\n## “Relational” databases{-}go option databases “relational” database - ’ll get scare quotes moment. ’s good reasons , ’s established technology lots problems already solved lots people familiar SQL (Structured Query Language) used access . let’s see fits data.Data relational databases tables, linked together keys. instance table “observations,” latlon, speed, time etc. ’d also column key table called “segments” shows segment used, information segment, class speed limit. observations tables also key column linked table called trips, can linked vehicles adjacent stops instance. table stops can also linked vehicles, potentially table locations.straight forward common kind query might want; finding speeds given road segment. get segments table link observations table filter segment whatever time period want. get location want link stops table filter see many stops .another major kind query call “tours.” Recall trip, framework, just whatever two stops. regular speech though “trip” like journey specific places. might journey Melbourne Sydney, even truck stops driver sleep, eat otherwise just rest. framework call tour, define differently based specific purpose; stop 8 hours Melbourne Brisbane makes sense, stop long Canberra Sydney probably means ’s two journeys back back.need string stops together define tours, query won’t just link two rows, arbitrary number stops make tour. isn’t impossible SQL relational databases, ’s easy either. data base going used data people, computer scientists, don’t want make hassle necessary.’s also another problem, even simple segment query mentioned. Remember every time match ping road segment also get list segments leading . get recorded observation several imputed observations road segments, associated time stamp, latlon, speed distance travelled. keep separate rows table, ’re duplicating basically everything except link segment table. seems waste space resources. Ideally ’d link one row observation table several rows segment table. , isn’t impossible, isn’t straightforward.","code":""},{"path":"storage---why-a-graph.html","id":"graph-databases","chapter":"6 Storage - Why a graph?","heading":"Graph databases","text":"end looked graph databases instead. graph database? talked people went research found lot explainers started variations “unlike relational databases, graph databases store data series relationships.” didn’t really help much! However true main way graph databases different relational databases relationships. Now get used scare quotes “relational database.”, graph doesn’t mean plot data, means network. already start thinking graph terms looked road networks.Graph databases store information nodes linked one another relationships. ’re obviously used things like social media networks user node. post user node. user linked post edge saying wrote . Another user attached first user edge saying follow . user also attached post edge saying liked . query just finds node interested follows paths get info need.look us?segment queries location queries fairly easy. road segment node attached number observation nodes edge saying observation segment. observations turn number edges segments showing segments recorded imputed . Likewise location node, like rest stop, linked number stops. start segment location node follow paths along edges find data.’s tour queries graph logic helps us. Say want find vehicles moved Melbourne Brisbane. set parameters, say, starting ending stop must least hour seem like destinations, can’t stop way 16 hours. also want make sure whole tour less , say, 48 hours lest get trucks go around country arriving Brisbane. graph database first finds stops Melbourne. follows edge saying “next stop.” Reaching next stop checks things. 48 hours first stop? stop move . Brisbane? tour! Brisbane, 16 hours duration? move . stop isn’t Brisbane yet, also 48 hours later long, follow next stop edge, repeat process.much intuitive ways done relational database.Graph databases fairly new, especially compared venerable relational database, technology isn’t settled way make choices. bunch considerations performance cost won’t consider , major one project query language used - way humans can ask database data. Relational databases well settled well known SQL, different graph databases favoured different languages; good purposes? three main candidates.","code":""},{"path":"storage---why-a-graph.html","id":"graphql","chapter":"6 Storage - Why a graph?","heading":"GraphQL","text":"GraphQL developed Facebook use released open standard. favoured language databases like DGraph. designed queries social media website shows. queries look like JSON, commonly used share data web services, connected nodes nested structure brackets format data come . good embedding web applications queries written machine, doesn’t quite capture intuitive movement along paths graph; example difference attribute “name” edge “friends” relies curly brackets. isn’t well suited data analysts trying write queries.","code":"{\n  hero {\n    name\n    friends {\n      name\n    }\n  }\n}"},{"path":"storage---why-a-graph.html","id":"gremlin","chapter":"6 Storage - Why a graph?","heading":"Gremlin","text":"Another option Gremlin developed Apache TinkerPop favoured databases OrientDB. built integration applications written Java many languages emulate Java’s syntax, object oriented dot syntax. can roughly think database blob bunch buttons. can press button gives segment nodes another blob button give edges observations. keep pressing buttons blobs get button returns average speeds. practice buttons accessed dot (.) object tied together.Wikipedia describes following example “80’s action movies 30-something programmers like? Group count movies name sort group count map decreasing order value.”can puzzle ’s still great purposes. need pay attention see switches following edges accessing attributes uses dots. Data analysis statistics isn’t really favourable object orientated languages general, , like GraphQL, friendly application developers isn’t friendly users.","code":"g.V().\n  match(\n  __.as('a').hasLabel('movie'),\n  __.as('a').out('category').has('name','Action'),\n  __.as('a').has('year',between(1980,1990)),\n  __.as('a').inE('rated').as('b'),\n  __.as('b').has('stars',5),\n  __.as('b').outV().as('c'),\n  __.as('c').out('occupation').has('name','programmer'),\n  __.as('c').has('age',between(30,40))).\n  select('a').groupCount().by('name').\n  order(local).by(valueDecr).\n  limit(local,10)"},{"path":"storage---why-a-graph.html","id":"cypher","chapter":"6 Storage - Why a graph?","heading":"Cypher","text":"eventually settled Cypher, developed Neo4j database released open standard. incorporates structure graph directly syntax. example might query average speed segment hour day.Hopefully intuitive . ’re looking two kinds nodes, Segment Observation attached edge labelled . visually apparent, edge even arrow showing observation segment way around. example ’ve restricted Segment observation one segment ID want. return attributes nodes dots, even attributes attributes, instance extracting hour datetime observation. returning attribute next function (mean) query function separately value attribute.different bits clear syntactically. nodes look like (Node), edges look like -[:EDGES]->, attributes look like Node.attribute functions look like function(). makes writing queries much easier data analyst users.data database, can work.","code":"MATCH (s:Segment{osm_id: $SEGMENT_ID\"})<-[:ON]-(o:Observation)\nRETURN o.datetime.hour, mean(o.imputed_speed) as average_speed"},{"path":"a-small-sample-of-what-weve-done-so-far.html","id":"a-small-sample-of-what-weve-done-so-far","chapter":"7 A small sample of what we’ve done so far","heading":"7 A small sample of what we’ve done so far","text":"’s lot can data, ’s small sample ’ve done far, ideas ","code":""},{"path":"a-small-sample-of-what-weve-done-so-far.html","id":"routes-and-congestion","chapter":"7 A small sample of what we’ve done so far","heading":"Routes and congestion","text":"One aims project learning road network. road matching individual road segments, starting point. particular road users planners care congestion, congestion? people answer something many vehicles insufficient infrastructure mainly worried effects. One effect slower speeds otherwise desirable; context means deliveries take longer need increases costs firms clients. effect uncertainty; ’re unsure long delivery take makes much harder plan, clients unable count delivery agreed time. Knowing times places congestion delays uncertainty happen helps planning governments, firms clients acn negotiate times.given segment lot observations, speed time stamp. means can calculate distribution speeds hour day, day week breakdown want. ’s also lots statistics use convey speed uncertainty given time decided two simple ones make accessible everyone. median speed (midpoint speed observe) interquartile range (rang eof middle 50 per cent speeds)8. median speed lower, speeds generally lower. interquartile range wider, ’s less certain long things take. graph example segment heading west M5 Sydney, snapped house visualisation. dark blue median speed, light blue interquartile range. Speed uncertainty ok except early morning motorway shared returning commuters afternoon evening.graph described textThe users data probably care whole journeys individual segments. get need collate segment data together. , say, wanted see long take travel M5 Hume Motorway Port Botany Sydney, select segments manually, take wouldn’t help ad hoc inquiries. Luckily adapt Open Source Routing Machine (OSRM) mentioned map matching chapter. long provided start end point9 minor tweak OSRM code meant returned list segments route.10 ’s whole west bound route M5, animated.animated gif M5 showing points delay peak hours near M5 tunnelThis worked great day, motorways lots data, run problems data scarce. routes might segment 3am observations. Even small amount data ran risk outliers. truck spent time traffic light pings drags averages unless swamped better data. , routes implausibly messy volatile. just wait data come , might also want track changes shorter time periods, instance comparing congestion week week.end problem solved COVID-19 pandemic, two things. First occupy whilst systems caught working home, secondly suddenly lot interest seeing effect sudden drop commuter traffic freight congestion. former led finally learn basics Bayesian inference , crude terms, lets use small amounts data adapting reasonable prior belief. , realised, meant prior like “speeds segment probably like speeds nearby segments time” “probably like speeds segment times,” tweak belief small amounts data get reasonable estimates. Applied need see effects lockdown resulted paper graphs like , estimates speeds even hour week, showing travel time peaks eliminated initial lockdowns.graph showing expected travel times Monash Frewway Dandenong city weeks Jan 6th Jan 12, Feb 24 March 1 April 20 April 26th, pronounced peaks noticeable February dataSubsequently blossomed ongoing series major reports congestion major Australian cities (alternately gitbook form . can find code .","code":""},{"path":"a-small-sample-of-what-weve-done-so-far.html","id":"freight-data-hub","chapter":"7 A small sample of what we’ve done so far","heading":"Freight data hub","text":"colleagues Department also created National Freight Data Hub , along sources, uses data road segments rest areas. makes easier planners drivers estimate travel times ad hoc routes, see rest facilities , popular facilities .","code":""},{"path":"a-small-sample-of-what-weve-done-so-far.html","id":"port-maps","chapter":"7 A small sample of what we’ve done so far","heading":"Port Maps","text":"","code":""},{"path":"a-small-sample-of-what-weve-done-so-far.html","id":"potential-future-work","chapter":"7 A small sample of what we’ve done so far","heading":"Potential future work","text":"’s lots work keen , work even existing products need . One thing keen explore “community detection.” data already graph database one form graph analysis discovers communities nodes, instance clusters friends social network. can also applied spatially, instance paper determined economic geography United States based commutes Census, finding labour market regions always aligned administrative boundaries. Perhaps freight geography Australia planners yet fully understand; community detection graph help discover .last, ’s major unanswered question. “Yulo?”","code":""},{"path":"why-yulo.html","id":"why-yulo","chapter":"8 Why Yulo","heading":"8 Why Yulo","text":"project known, rather straightforwardly, BITRE Freight Telematics Program. framework, code, called Yulo. ?examining early results make sure made sense happened look Watt St Newcastle, NSW. Watt St often described “Newcastle’s first street,” track already Europeans first used 1804, used untold centuries Awabakal people. Watt St part road network predates Europeans tar concrete. One first things convicts First Fleet attempted landing Australian soil take paths found ships La Perouse moored Botany Bay; paths now Anzac Parade, large parts regional highway network said based routes first taken Europeans reliant Aboriginal guides.highlighted point made map matching chapter, work consider roads places things made tar concrete, ways B, paths two places.logo made Yulo. stylised representation path every SA2 region Australia Alice Springs, derived using OSRM. Paths flowing every part country.Yulo logo, described text","code":""}]
